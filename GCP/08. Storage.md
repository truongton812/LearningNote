# Storage

## Phân biệt block/file/object storage
### Block storage
- Block storage chia dữ liệu thành các khối (block) có kích thước cố định, mỗi khối có địa chỉ riêng biệt. Hệ thống có thể truy cập và cập nhật từng khối riêng lẻ mà không cần thay đổi toàn bộ dữ liệu. Block storage thường được dùng cho các ứng dụng cần tốc độ cao và độ trễ thấp như cơ sở dữ liệu, máy ảo hoặc hệ thống yêu cầu hiệu suất cao.
- Mỗi volume block storage thường được attach vào một máy chủ hoặc một máy ảo duy nhất tại một thời điểm và thường không có cơ chế để nhiều máy ghi dữ liệu đồng thời vào cùng một volume để tránh lỗi ghi chồng chéo dữ liệu (data corruption) do không có cơ chế đồng bộ ghi giữa các máy.
- Block storage phù hợp khi bạn cần lưu trữ block gắn vào một máy chủ hoặc máy ảo duy nhất để sử dụng như ổ đĩa hệ điều hành, cơ sở dữ liệu hoặc ứng dụng đòi hỏi hiệu suất cao, độ trễ thấp. EBS thường dùng cho các workload cần truy cập dữ liệu nhanh, hay write-intensive, hoặc khi bạn cần kiểm soát chi tiết về block device như định dạng, phân vùng.
- Ví dụ: Ổ cứng (HDD/SSD), SAN (Storage Area Network), Amazon EBS (Elastic Block Store), GCP Persistent disk, GCP Local SSD

### File Storage
- File storage tổ chức dữ liệu theo dạng tệp (file) và thư mục (folder), giống như hệ thống tập tin trên máy tính. Người dùng có thể dễ dàng truy cập, chia sẻ và quản lý dữ liệu thông qua cấu trúc cây thư mục.
- File storage hỗ trợ nhiều máy tính cùng truy cập và ghi dữ liệu đồng thời vào cùng một hệ thống lưu trữ file mà không gặp xung đột
- File Storage thích hợp khi bạn cần một hệ thống file chia sẻ, có thể truy cập đồng thời bởi nhiều máy chủ hoặc container trong mạng. EFS phù hợp cho ứng dụng như lưu trữ dữ liệu dùng chung của web servers, ứng dụng phân tán, hoặc môi trường container, nơi nhiều client cần truy cập cùng lúc.
- Ví dụ: Máy tính cá nhân, NFS (Linux), SMB/CIFS (Window), NAS (Network Attached Storage), Google Drive, Dropbox, GCP FileStore, EFS

### Object Storage
- Object storage lưu trữ dữ liệu dưới dạng các đối tượng (object), mỗi đối tượng gồm dữ liệu, metadata (thông tin mô tả) và một định danh duy nhất. Object storage phù hợp cho lưu trữ dữ liệu phi cấu trúc, dung lượng lớn và cần mở rộng linh hoạt.
- Ví dụ: Amazon S3, Google Cloud Storage, các hệ thống lưu trữ ảnh, video, backup dữ liệu lớn

## GCP Block Storage
- GCP cung cấp 2 loại block storage là local SSD và persisten disk

### Local SSD
- Là storage được attach trực tiếp vào host của VM instance
- Cung cấp very high IOPS và very low latency
- Lifecycle gắn liền với instance nên chỉ dùng để chứa temp data. Nếu muốn giữ data nếu có maintainance event thì cần enable tính năng "live migration"
- Data tự động được encrypted bằng key của Google (không thể chỉ định key)
- Chỉ hỗ trợ 1 số loại instance
- Không thể detach và attach sang instance khác
- Support 2 loại interfaces là SCSI và NVMe (là interface dùng để connect local SSD với VM). Cần sử dụng image phù hợp (NVMe-enabled image hoặc multi-queue SCSI image)
- Nếu muốn tăng performance thì tăng dung lượng của SSD và tăng số vCPU của VM
- Không hỗ trợ snapshot
- Use case: caches, temp data, scratch file,...

### Persistent disk
- Là storage dùng để chứa peristent data do lifecycle không gắn với instance
- Có thể tạo persistent disk regional hoặc zonal. Regional PDs sẽ được replicated data qua 2 zone khác nhau của 1 region (x2 price so với zonal PDs). Nếu muốn move 1 PD từ zone này sang zone khác để attach với VM ở zone khác thì cần copy sang
- Linh hoạt trong việc tăng giảm size mà không cần detach khỏi instance
- Performance tăng tỉ lệ thuận với size
- Có thể detach và attach sang instance khác
- Hỗ trợ snapshot
- Use case: dùng cho database


### Machine images
- Multiple disk (boot disk và data disk) có thể attach vào cùng 1 VM
- Image là thành phần được tạo ra từ boot disk, còn machine image là được tạo ra từ VM instance (hỏi thêm gpt cho rõ)
- Machine image chứa tất cả những gì cần thiết để tạo VM instance (config, metadata, permission của VM instance, và data từ tất cả các disk)
- Machine image dùng khi muốn clone hoặc replicate 1 VM instance
- Machine image có thể encrypt bằng key của customer
