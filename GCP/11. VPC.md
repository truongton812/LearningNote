Private Service Connect (PSC)﻿ là một tính năng mạng của Google Cloud cho phép bạn access hoặc publish dịch vụ một cách riêng tư bằng IP nội bộ trong VPC﻿, thay vì đi qua Internet công khai.​

Khái niệm cốt lõi

Service consumer﻿ và service producer﻿:

- Consumer﻿ là VPC muốn dùng dịch vụ (ví dụ VPC của bạn). Trong VPC tạo PSC endpoint﻿, Là một IP nội bộ trong subnet VPC của bạn, tạo bằng forwarding rule﻿ với purpose = PRIVATE_SERVICE_CONNECT﻿. Ứng dụng trong VPC chỉ cần gọi IP/hostname này, giống như gọi một service nội bộ.

- Producer﻿ là nơi chạy dịch vụ được quản lý (có thể là Google, bên thứ ba, hoặc chính bạn ở VPC khác).​ Trong producer tạo Service attachment (thường đứng trước một Internal HTTP(S) Load Balancer﻿ hoặc TCP/UDP Load Balancer) để định nghĩa dịch vụ nào sẽ nhận traffic từ các PSC endpoint,

PCS giúp truy cập tới các dịch vụ (Google APIs/services﻿ như Cloud Storage﻿, Bigtable﻿, ... dịch vụ của bên thứ ba (ví dụ MongoDB Atlas﻿, Snowflake﻿) cung cấp qua PSC, dịch vụ nội bộ giữa các VPC trong cùng tổ chức (ví dụ team A publish API cho team B dùng) bằng mạng internal của Google mà không cần ra internet. Traffic luôn đi trên backbone của Google, không “lộ” ra Internet công khai; bạn không cần Internet gateway﻿ hay VPC peering﻿, giảm độ phức tạp mạng.​




Cách setup:
- Phía producer: Đặt dịch vụ sau một Internal Load Balancer﻿ → tạo service attachment﻿ cho LB đó.
- Phía consumer: Trong VPC, tạo một PSC endpoint﻿ (forwarding rule + internal IP) trỏ tới service attachment﻿. Optional: tạo private DNS﻿ để hostname nội bộ trỏ tới IP PSC.

<img width="700" height="326" alt="image" src="https://github.com/user-attachments/assets/c0bb8d8c-6857-41d2-8f48-cc0cbff4d020" />

---

GraphQL service (để ingress=internal-and-cloud-load-balancing) được expose qua một HTTP(S) Load Balancer﻿ + Serverless NEG﻿ do Google quản lý.​ Bạn publish LB này thành một PSC service attachment﻿. Cách làm: Vào Private Service Connect﻿ → tab Published services﻿ → Publish service﻿. Chọn Target type﻿ = Load balancer﻿, pick cái Internal LB vừa tạo. → Tạo Service attachment﻿. Lưu lại service attachment URI﻿ dùng cho bên consumer.

Trong VPC (consumer VPC) bạn tạo PSC endpoint﻿ (internal IP) trỏ tới service attachment URI.​

Cho frontend Cloud Run gọi qua VPC: Frontend Cloud Run﻿ muốn gọi PSC endpoint cần Direct VPC Egress﻿ hoặc Serverless VPC Access connector (còn gọi là VPC connector)﻿ trỏ vào consumer VPC đó.​ ( VPC connector/direct VPC egress﻿ giúp Frontend Cloud Run gửi được traffic vào VPC, do khi tạo GraphQL cloud run ta chọn type ingress=internal-and-cloud-load-balancing -> chỉ traffic từ vpc hoặc LB mới đi vào graphQL service được)

Khi frontend Cloud Run gọi vào PSC endpoint﻿ sẽ được route request ra dịch vụ Cloud Run﻿ ở phía producer.

---

Serverless VPC Access connector là một tài nguyên được quản lý hoàn toàn bởi Google Cloud, hoạt động như một cầu nối (bridge) giữa các dịch vụ serverless (như Cloud Run, Cloud Functions, App Engine) và mạng VPC của bạn, cho phép gửi traffic outbound từ serverless đến các tài nguyên nội bộ VPC mà không đi qua internet công cộng.​

Cách hoạt động

Connector được tạo trong một project, gắn với VPC network và region cụ thể, sử dụng dải IP riêng (RFC 1918 hoặc RFC 6598) để serverless services gửi request đến VM Compute Engine, Memorystore, database on-prem qua VPN/Interconnect, hoặc các tài nguyên khác có internal IP/DNS. Traffic response từ VPC chỉ quay về serverless nếu là phản hồi cho request outbound từ connector, đảm bảo độ trễ thấp hơn internet và bảo mật cao (không expose ra public).​

Use case: Cloud Run gọi MongoDB Atlas private, truy cập VM backend, hoặc on-prem DB qua VPN – lý tưởng cho kiến trúc private Cloud Run của bạn.​

