# Google Kubernetes Engine

- Là dịch vụ managed Kubernetes do Goolge cung cấp
- Các tính năng:
  - Tự động repair các failed nodes và tự động upgrade latest version K8S
  - Pod & Cluster Autoscaling
  - Tích hợp với Cloud Logging và Cloud Monitoring
  - Có thể attach persistent disk/local SSD cho node
 
- Khi tạo K8S cluster sẽ có 2 options:
  - Standard: tự mình quản lý cluster
  - Autopilot: Google quản lý cluster
 
- Node pool: là một nhóm các nodes trong cùng một cluster mà tất cả các node này có cấu hình giống nhau. Mỗi node pool sử dụng một cấu hình NodeConfig nhất định để định nghĩa thông số cho tất cả node trong pool đó, như loại máy ảo, số lượng CPU, bộ nhớ, ổ đĩa, hình ảnh hệ điều hành dùng trên node, v.v. Khi tạo một cluster GKE chế độ Standard, có thể tạo nhiều node pool với các cấu hình khác nhau. Có thể điều phối pod chạy trên các node pool cụ thể bằng cách dùng selector trong manifest của pod, ví dụ bằng `nodeSelector: cloud.google.com/gke-nodepool: <POOL_NAME>`

- Khi tạo service dạng load balancer, sẽ có 1 load balancer tương ứng sỉnh ra trên GCP
  
- Command

`gcloud container clusters create` : tạo cluster

`gcloud container clusters get-credentials <cluster_name> --zone <zone> --project <project_id>` : kết nối đến cluster

`gcloud config set container/cluster VALUE` : set default cluster để làm việc với command gcloud container

`gcloud container clusters resize <cluster_name> --node-pool <node_pool> --num-nodes <int>` : scale số lượng nodes thủ công

`gcloud contaniner clusters update <cluster_name> --enable-autoscaling --min-nodes=1 --max-nodes=10` : enable scale số lượng nodes tự động. Khi số lượng pods tăng/giảm thì nodes sẽ tự động scale up/down

`gcloud container node-pools create <pool_name> --cluster <cluster_name>` : tạo node pool

`gcloud container node-pools list --cluster <cluster_name> --zone <zone>` : list ra các node pool

`kubectl autoscale deployment <deployment_name> --max=<int> --cpu-percent=<int>` : scale pod của deployment dựa theo phần trăm cpu. Check hpa resource để lấy thông tin

`gcloud container clusters delete` : xóa cluster
