# Example

## Example 1

```
import news
from flask import Flask, redirect, request
from flask.ext.api import status
from google.appengine.api import users

app = Flask(__name__)
sessions = {}

@app.route("/")
def homepage():
    user = users.get_current_user()
    if not user:
        return "Invalid login", status.HTTP_401_UNAUTHORIZED

    if user not in sessions:
        sessions[user] = {"viewed": []}

    news_articles = news.get_new_news(user, sessions[user]["viewed"])
    sessions[user]["viewed"] += [n["id"] for n in news_articles]

    return news.render(news_articles)

if __name__ == "__main__":
    app.run()

```
Giải thích
- `import news` : import module news để thao tác với dữ liệu tin tức
- `from flask import Flask, redirect, request` : import các module cần thiết
  - flask: là module (thực ra chính xác là một "package", nhưng thường gọi là module). Đây là một thư mục chứa nhiều file Python liên quan đến Flask, được cài vào môi trường Python của bạn như một library (thư viện) dùng cho lập trình web.​
  - Flask: là class (lớp), được định nghĩa trong module flask. Class này dùng để tạo một đối tượng ứng dụng web Flask.
  - redirect, request: là function (hàm) hoặc object khác (ví dụ: object request là một proxy), đều được định nghĩa bên trong module (thư viện) flask.
- `app = Flask(__name__)`: khởi tạo một đối tượng ứng dụng Flask  
  - __name__ là một biến đặc biệt trong Python chứa tên của module hiện tại.​ Giá trị cụ thể của __name__ là "__main__" nếu file đó được chạy trực tiếp (VD bằng cách gọi lệnh python filename.py), và là "tên_file_module" nếu file đó được import vào file khác. Ví dụ có một file tên là app.py trong đó có dòng print(__name__), thì khi bạn chạy `python app.py` sẽ in ra `__main__`. Nếu file này được import vào file khác (vd: import app trong another.py), thì sẽ in ra `app`
  - Khi bạn viết `app = Flask(__name__)` và chạy file Python trực tiếp, câu lệnh này sẽ tương đương với: `app = Flask("__main__")`. Flask dùng giá trị chuỗi "__main__" để xác định vị trí file hiện tại, từ đó giúp module biết ngữ cảnh đang chạy. Flask cần biết ngữ cảnh do ứng dụng Flask có thể xử lý nhiều request cùng lúc (đa luồng hoặc đa tiến trình). Nếu dùng biến toàn cục thông thường để lưu trạng thái ứng dụng hoặc request, sẽ xảy ra hiện tượng xung đột dữ liệu, không biết biến đó thuộc phiên làm việc của request nào -> ngữ cảnh như một "khung chứa dữ liệu nội bộ" riêng biệt cho từng request.
  - Cách Flask dùng ngữ cảnh thực thi:
    - Khi request tới, Flask khởi tạo Request Context chứa thông tin yêu cầu.
    - Flask khởi tạo Application Context chứa thông tin ứng dụng hiện hành.
    - Trong quá trình xử lý, các hàm, extension truy cập dữ liệu qua context, đảm bảo đúng request, đúng trạng thái ứng dụng.
    - Khi request hoàn tất, ngữ cảnh được hủy, giải phóng tài nguyên.
- `sessions = {}` : khai báo biến toàn cục tên sessions dạng từ điển (dict) để lưu trữ trạng thái phiên truy cập (session) của từng user.​
- `@app.route("/")` : Định nghĩa route cho trang chủ
- `homepage()` : hàm sẽ thực thi khi truy cập địa chỉ gốc ("/").​
- `user = users.get_current_user()` : lấy user hiện tại. Nếu chưa đăng nhập, trả về lỗi 401 (Unauthorized).​ Nếu user chưa có trong hệ thống sessions, sẽ khởi tạo mới một session với khóa là đối tượng user, giá trị là một dict chứa danh sách các bản tin đã xem ("viewed": []).​
- `news.get_new_news(user, sessions[user]["viewed"])` : lấy danh sách các bản tin chưa xem của user đó.​
- `news.render(news_articles)` : render các bản tin để gửi nội dung ra trình duyệt.​
- `if __name__ == "__main__": app.run()`: là câu lệnh để kiểm tra chỉ chạy server khi file được chạy trực tiếp, tránh chạy khi import module
- `app.run()`: khởi tạo Flask khi chạy trực tiếp

## Example 2
```
from http.server import HTTPServer, BaseHTTPRequestHandler

class HelloHandler(BaseHTTPRequestHandler):
    def do_GET(self):
        self.send_response(200)
        self.send_header('Content-type', 'text/html')
        self.end_headers()
        self.wfile.write(b"User ver 1.0.0")

if __name__ == "__main__":
    server_address = ('0.0.0.0', 8000)
    httpd = HTTPServer(server_address, HelloHandler)
    print("Server đang chạy tại http://0.0.0.0:8000")
    httpd.serve_forever()
```
